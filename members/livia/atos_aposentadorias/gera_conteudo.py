import re
import pandas as pd
import numpy as np
from sklearn.svm import LinearSVC
from sklearn.svm import SVC
from sklearn.calibration import CalibratedClassifierCV
from sklearn import metrics
from sklearn.feature_extraction.text import TfidfVectorizer
import matplotlib.pyplot as plt



data = pd.read_excel('DODF_Atos_de_Aposentadoria_validados_201804_201909.xlsx')
data.drop(columns='COD_EMPRESA', inplace=True)

colunas = data.columns


conteudo = []
string = ""

i = 0
while i < len(data):
    for coluna in colunas:
        X = data[coluna][i]
        if X == X:
            string = string + str(X) + ' '


    conteudo.append(string)
    string = ''
    i = i + 1

data['conteudo'] = conteudo

label = data['EMPRESA_ATO']
labels =[]

for i in label:
    if i not in labels:
        labels.append(i)

labels_organizado = sorted(labels)

labels_organizado

labels_pular = ['ADMINISTRACAO REGIONAL DE CEILANDIA',
                'ADMINISTRACAO REGIONAL DO GAMA',
                'CONTROLADORIA-GERAL DO DISTRITO FEDERAL',
                'DETRAN',
                'ERVICO DE LIMPEZA URBANA DO DISTRITO FEDERAL',
                'PROCURADORIA GERAL DO DISTRITO FEDERAL',
                'PROCURADORIA-GERAL DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DA CASA CIVL, RELACOES INSTITUCIONAIS E SOCIAIS',
                'SECRETARIA DE ESTADO DA SEGURANCA PUBLICA E DA PAZ SOCIAL DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DE AGRICULTURA, ABASTECIMENTO E DESENVOLVIMENTO RURAL',
                'SECRETARIA DE ESTADO DE AGRICULTURA, ABASTECIMENTO E DESENVOLVIMENTO RURAL DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DE CULTURA DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DE CULTURA E ECONOMIA CRIATIVA DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DE CULTURA E ECONOMIA DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DE ESPORTE, E LAZER DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DE ESPORTE, TURISMO E LAZER',
                'SECRETARIA DE ESTADO DE INFRAESTRUTURA E SERVICOS PUBLICOS DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DE JUSTICA E CIDADANIA',
                'SECRETARIA DE ESTADO DE JUSTICA E CIDADANIA DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DE PLANEJAMENTO ORCAMENTO E GESTAO DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DE PLANEJAMENTO, ORCAMENTO E GESTAO',
                'SECRETARIA DE ESTADO DE PLANEJAMENTO, ORCAMENTO E GESTAO DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DE POLITICAS PARA CRIANCAS, ADOLESCENTES E JUVENTUDE',
                'SECRETARIA DE ESTADO DE POLITICAS PARA CRIANCAS, ADOLESCENTES E JUVENTUDE DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DE SEGURANCA PUBLICA E DA PAZ SOCIAL DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DO MEIO AMBIENTE DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DO DESENVOLVIMENTO URBANO E HABITACAO DO DISTRITO FEDERAL'
                'SECRETARIA DE ESTADO DE TRABALHO, DESENVOLVIMENTO SOCIAL, MULHERES, IGUALDADE RACIAL E DIREITOS HUMANOS DO DISTRITO FEDERAL',
                'SECRETARIA DE ESTADO DO TRABALHO, DESENVOLVIMENTO SOCIAL, MULHERES, IGUALDADE RACIAL E DIREITOS HUMANOS',
                'SECRETARIA DE ESTADO DE TRABALHO, DESENVOLVIMENTO SOCIAL, MULHERES, IGUALDADE RACIAL E DIREITOS HUMANOS',
               ]

labels_to_int = {}
inteiro = 0

for j in labels_organizado:
    if j not in labels_pular:
        labels_to_int[j] = inteiro
        inteiro += 1

labels_to_int


labels_to_int['ADMINISTRACAO REGIONAL DE CEILANDIA'] = 0
labels_to_int['ADMINISTRACAO REGIONAL DO GAMA'] = 3
labels_to_int['CONTROLADORIA-GERAL DO DISTRITO FEDERAL'] = 18
labels_to_int['DETRAN'] = 22
labels_to_int['ERVICO DE LIMPEZA URBANA DO DISTRITO FEDERAL'] = 59
labels_to_int['PROCURADORIA GERAL DO DISTRITO FEDERAL'] = 29
labels_to_int['PROCURADORIA-GERAL DO DISTRITO FEDERAL'] = 29
labels_to_int['SECRETARIA DE ESTADO DA CASA CIVL, RELACOES INSTITUCIONAIS E SOCIAIS'] = 31
labels_to_int['SECRETARIA DE ESTADO DA SEGURANCA PUBLICA E DA PAZ SOCIAL DO DISTRITO FEDERAL'] = 32
labels_to_int['SECRETARIA DE ESTADO DE AGRICULTURA, ABASTECIMENTO E DESENVOLVIMENTO RURAL'] = 30
labels_to_int['SECRETARIA DE ESTADO DE AGRICULTURA, ABASTECIMENTO E DESENVOLVIMENTO RURAL DO DISTRITO FEDERAL'] = 30
labels_to_int['SECRETARIA DE ESTADO DE CULTURA DO DISTRITO FEDERAL'] = 33
labels_to_int['SECRETARIA DE ESTADO DE CULTURA E ECONOMIA CRIATIVA DO DISTRITO FEDERAL'] = 33
labels_to_int['SECRETARIA DE ESTADO DE CULTURA E ECONOMIA DO DISTRITO FEDERAL'] = 33
labels_to_int['SECRETARIA DE ESTADO DE ESPORTE, E LAZER DO DISTRITO FEDERAL'] = 40
labels_to_int['SECRETARIA DE ESTADO DE ESPORTE, TURISMO E LAZER'] = 40
labels_to_int['SECRETARIA DE ESTADO DE INFRAESTRUTURA E SERVICOS PUBLICOS DO DISTRITO FEDERAL'] = 44
labels_to_int['SECRETARIA DE ESTADO DE JUSTICA E CIDADANIA'] = 45
labels_to_int['SECRETARIA DE ESTADO DE JUSTICA E CIDADANIA DO DISTRITO FEDERAL'] = 45
labels_to_int['SECRETARIA DE ESTADO DE PLANEJAMENTO ORCAMENTO E GESTAO DO DISTRITO FEDERAL'] = 49
labels_to_int['SECRETARIA DE ESTADO DE PLANEJAMENTO, ORCAMENTO E GESTAO'] = 49
labels_to_int['SECRETARIA DE ESTADO DE PLANEJAMENTO, ORCAMENTO E GESTAO DO DISTRITO FEDERAL'] = 49
labels_to_int['SECRETARIA DE ESTADO DE POLITICAS PARA CRIANCAS, ADOLESCENTES E JUVENTUDE'] = 50
labels_to_int['SECRETARIA DE ESTADO DE POLITICAS PARA CRIANCAS, ADOLESCENTES E JUVENTUDE DO DISTRITO FEDERAL'] = 50
labels_to_int['SECRETARIA DE ESTADO DE SEGURANCA PUBLICA E DA PAZ SOCIAL DO DISTRITO FEDERAL'] = 54
labels_to_int['SECRETARIA DE ESTADO DO MEIO AMBIENTE DO DISTRITO FEDERAL'] = 46
labels_to_int['SECRETARIA DE ESTADO DO DESENVOLVIMENTO URBANO E HABITACAO DO DISTRITO FEDERAL'] = 36
labels_to_int['SECRETARIA DE ESTADO DE TRABALHO, DESENVOLVIMENTO SOCIAL, MULHERES, IGUALDADE RACIAL E DIREITOS HUMANOS DO DISTRITO FEDERAL'] = 58
labels_to_int['SECRETARIA DE ESTADO DO TRABALHO, DESENVOLVIMENTO SOCIAL, MULHERES, IGUALDADE RACIAL E DIREITOS HUMANOS'] = 58
labels_to_int['SECRETARIA DE ESTADO DE TRABALHO, DESENVOLVIMENTO SOCIAL, MULHERES, IGUALDADE RACIAL E DIREITOS HUMANOS'] = 58

labels_to_int

int_label = []
for i in label:
    for j in labels_to_int:
        if i == j:
            int_label.append(labels_to_int[j])


data['int_label'] = int_label
data['labels'] = data['EMPRESA_ATO']

data


data.to_csv("DODF_Aposentadoria.csv")
